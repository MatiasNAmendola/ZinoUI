/*!
 * ZinoUI v1.3 (http://zinoui.com)
 * Copyright 2012-2013 Dimitar Ivanov. All Rights Reserved.
 *
 * Zino UI commercial licenses may be obtained at http://zinoui.com/license
 * If you do not own a commercial license, this file shall be governed by the
 * GNU General Public License (GPL) version 3.
 * For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
 */
(function(c,r){function q(){this._defaults={dataSource:null,easing:"linear",expandDuration:350,collapseDuration:"fast",expand:null,collapse:null,select:null,remove:null}}q.prototype={_attachTreeview:function(b,a){function e(l,a,g){for(var m=0,h=l.length;m<h;m++)l[m].parent_id===a&&(n=["zui-treeview-label-",f.uid,"-",p].join(""),k=c("<li>").attr({role:"treeitem",tabindex:-1,"aria-expanded":!1,"aria-labelledby":n}).addClass("zui-treeview-item").append(c("<div>").attr("id",n).addClass("zui-treeview-label").html(l[m].text)).append(c("<ul>").attr("role",
"group").addClass("zui-treeview-list")),l[m].expanded&&d._expandTreeview.call(d,b,k),l[m].selected&&d._selectTreeview.call(d,b,k),k.appendTo(g.children("ul")),p+=1,e(l,l[m].id,k))}function g(){h.find(".zui-treeview-label").each(function(b,a){var d=c(a),e=d.siblings("ul"),f=d.parent("li");0<e.children().length?d.before(c("<span>").attr("role","presentation").addClass("zui-treeview-arrow").addClass("false"===f.attr("aria-expanded")?"zui-treeview-arrow-collapse":"zui-treeview-arrow-expand")):e.remove()})}
if(this._getInst(b))return!1;var k,h=c(b),d=this,f=d._newInst(h);c.extend(f.settings,d._defaults,a);h.addClass("zui-treeview zui-unselectable").append(c("<ul>").attr({role:"tree","aria-labelledby":"",tabindex:0}).addClass("zui-treeview-list-root"));c.data(b,"treeview",f);var n,p=1;f.settings.dataSource.load(function(b){e(b,0,h);g()});h.on("mouseover.treeview",".zui-treeview-label",function(){c(this).addClass("zui-treeview-label-hover")}).on("mouseout.treeview",".zui-treeview-label",function(){c(this).removeClass("zui-treeview-label-hover")}).on("click.treeview",
".zui-treeview-label",function(){d._selectTreeview.call(d,b,c(this).parent("li"))}).on("dblclick.treeview",".zui-treeview-label",function(){var a=c(this).siblings("ul").eq(0);a.is(":visible")?d._collapseTreeview.call(d,b,a.parent("li")):d._expandTreeview.call(d,b,a.parent("li"))}).on("click.treeview",".zui-treeview-arrow-collapse",function(){d._expandTreeview.call(d,b,c(this).parent("li"))}).on("click.treeview",".zui-treeview-arrow-expand",function(){d._collapseTreeview.call(d,b,c(this).parent("li"))}).on("keydown.treeview",
"li",function(a){a.stopPropagation();switch(a.charCode?a.charCode:a.keyCode?a.keyCode:0){case 37:a.preventDefault();d._collapseTreeview.call(d,b,c(a.target));break;case 38:a.preventDefault();a=d._getPrevTreeview.call(d,b,d._getSelectedTreeview.call(d,b));d._selectTreeview.call(d,b,a);break;case 39:a.preventDefault();d._expandTreeview.call(d,b,c(a.target));break;case 40:a.preventDefault();a=d._getNextTreeview.call(d,b,d._getSelectedTreeview.call(d,b));a.hasClass("zui-treeview-item")&&"LI"===a.get(0).nodeName&&
d._selectTreeview.call(d,b,a);break;case 13:case 32:a.preventDefault();break;case 9:a.preventDefault()}return!0}).bind("treeviewexpand",function(a,c){null!==f.settings.expand&&f.settings.expand.call(b,a,c)}).bind("treeviewcollapse",function(a,c){null!==f.settings.collapse&&f.settings.collapse.call(b,a,c)}).bind("treeviewselect",function(a,c){null!==f.settings.select&&f.settings.select.call(b,a,c)}).bind("treeviewremove",function(a,c){null!==f.settings.remove&&f.settings.remove.call(b,a,c)});c.data(b,
"treeview",f)},_collapseTreeview:function(b,a){var e=this._getInst(b);if(!e||0===a.length)return!1;a.attr("aria-expanded",!1).children("span").removeClass("zui-treeview-arrow-expand").addClass("zui-treeview-arrow-collapse").end().children("ul").slideUp(e.settings.collapseDuration,e.settings.easing);0!==a.children("ul").length&&a.children("ul").is(":visible")||(e=a.closest(".zui-treeview-list").closest(".zui-treeview-item"),0<e.length&&this._selectTreeview.call(this,b,e));c(b).trigger("treeviewcollapse",
{item:a})},_expandTreeview:function(b,a){var e=this._getInst(b);if(!e||0===a.length)return!1;a.attr("aria-expanded",!0).children("span").removeClass("zui-treeview-arrow-collapse").addClass("zui-treeview-arrow-expand").end().children("ul").slideDown(e.settings.expandDuration,e.settings.easing);c(b).trigger("treeviewexpand",{item:a})},_collapseAllTreeview:function(b){if(!this._getInst(b))return!1;c(".zui-treeview-item",b).attr("aria-expanded",!1);c(".zui-treeview-arrow",b).removeClass("zui-treeview-arrow-expand").addClass("zui-treeview-arrow-collapse");
c(".zui-treeview-list",b).slideUp()},_expandAllTreeview:function(b){if(!this._getInst(b))return!1;c(".zui-treeview-item",b).attr("aria-expanded",!0);c(".zui-treeview-arrow",b).removeClass("zui-treeview-arrow-collapse").addClass("zui-treeview-arrow-expand");c(".zui-treeview-list",b).slideDown()},_removeTreeview:function(b,a){if(!this._getInst(b)||0===a.length)return!1;a.remove();c(b).trigger("treeviewremove",{item:a})},_getSelectedTreeview:function(b){return this._getInst(b)?c(".zui-treeview-label-selected",
b).parent():!1},_getPrevTreeview:function(b,a){if(!this._getInst(b)||!a||0===a.length)return!1;var c=a.prev(),g=a.parent().parent();return 0===c.length&&g.is("li")&&g.hasClass("zui-treeview-item")?g:c.has(".zui-treeview-list")&&"true"===c.attr("aria-expanded")?c.find(".zui-treeview-item").filter(":visible").last():c},_getNextTreeview:function(b,a){function c(a){a=a.parent().parent();var b=a.next();0===b.length?c(a):d=b}if(!this._getInst(b)||!a||0===a.length)return!1;var g=a.next(),k=a.has(".zui-treeview-list"),
h=a.attr("aria-expanded");if(0!==g.length||k&&"false"!==h)return k&&"true"===h?a.find(".zui-treeview-item").filter(":visible").first():g;var d;c(a,d);return d},_selectTreeview:function(b,a){if(!this._getInst(b)||!a||0===a.length)return!1;c(".zui-treeview-label",b).removeClass("zui-treeview-label-selected");c(".zui-treeview-item",b).attr("tabindex",-1);a.attr("tabindex",0).focus().children(".zui-treeview-label").addClass("zui-treeview-label-selected");c(b).trigger("treeviewselect",{item:a})},_newInst:function(b){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,
"\\\\$1"),input:b,uid:Math.floor(99999999*Math.random()),isDisabled:!1,settings:{}}},_getInst:function(b){try{return c.data(b,"treeview")}catch(a){throw"Missing instance data for this treeview";}}};c.fn.zinoTreeview=function(b){var a=Array.prototype.slice.call(arguments,1);return"string"==typeof b&&c.inArray(b,["isDisabled","getSelected","getNext","getPrev"])||"option"==b&&2==arguments.length&&"string"==typeof arguments[1]?c.zinoTreeview["_"+b+"Treeview"].apply(c.zinoTreeview,[this[0]].concat(a)):
this.each(function(){"string"==typeof b?c.zinoTreeview["_"+b+"Treeview"].apply(c.zinoTreeview,[this].concat(a)):c.zinoTreeview._attachTreeview(this,b)})};c.zinoTreeview=new q;c.zinoTreeview.version="1.3"})(jQuery);