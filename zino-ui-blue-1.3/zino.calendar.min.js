/*!
 * ZinoUI v1.3 (http://zinoui.com)
 * Copyright 2012-2013 Dimitar Ivanov. All Rights Reserved.
 *
 * Zino UI commercial licenses may be obtained at http://zinoui.com/license
 * If you do not own a commercial license, this file shall be governed by the
 * GNU General Public License (GPL) version 3.
 * For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
 */
(function(f,B){function w(c){var a,e=c?8:7,b=f("<tr>");for(c=0;c<e;c++)a=f("<td>").addClass("zui-calendar-empty"),a.appendTo(b);return b}function t(c,a){if(0<c&&c<a-1)return 0;if(0<c&&c===a-1)return 2;if(0===c&&c===a-1)return 3;if(0===c&&c<a-1)return 1}function x(c,a){function e(c){return 2===(c+"").length?c:"0"+c}var b,f,d,h=[],n=new Date(a);b=0;for(f=c.length;b<f;b++)switch(d=c.charAt(b),d){case "Y":h.push(n.getFullYear());break;case "y":h.push((n.getFullYear()+"").slice(-2));break;case "m":h.push(e(n.getMonth()+
1));break;case "n":h.push(n.getMonth()+1);break;case "F":h.push(this.opts.monthNamesFull[n.getMonth()]);break;case "M":h.push(this.opts.monthNames[n.getMonth()]);break;case "d":h.push(e(n.getDate()));break;case "j":h.push(n.getDate());break;case "D":h.push(this.opts.dayNamesFull[n.getDay()].slice(0,3));break;case "l":h.push(this.opts.dayNamesFull[n.getDay()]);break;default:h.push(d)}return h.join("")}function D(c,a){var e,b,g,d,h;e=[".","-","/"];b=0;for(d=e.length;b<d;b++)if(-1!==c.indexOf(e[b]))return d=
c.split(e[b]),h=a.split(e[b]),e=f.inArray("Y",h),b=f.inArray("m",h),g=f.inArray("d",h),-1===b&&(b=f.inArray("n",h)),-1===g&&(g=f.inArray("j",h)),[d[e],d[b],d[g]].join("-");return c}function u(c,a){var e=Object.prototype.toString.call(a).slice(8,-1);return a!==B&&null!==a&&e===c}function v(){this.selectedDate=this.id=null;this._state=[];this._defaults={year:(new Date).getFullYear(),month:(new Date).getMonth(),dayNames:"Su Mo Tu We Th Fr Sa".split(" "),dayNamesFull:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthNamesFull:"January February March April May June July August September October November December".split(" "),startDay:0,weekNumbers:!1,selectOtherMonths:!1,showOtherMonths:!0,showNavigation:!0,months:1,inline:!1,disablePast:!1,dateFormat:"Y-m-d",position:"bottom",minDate:null,beforeOpen:null,beforeClose:null,open:null,close:null,select:null,onBeforeShowDay:function(){return[!0,""]}}}var r=new Date,E=[r.getFullYear(),r.getMonth(),
r.getDate()].join("-"),F=new Date(r.getFullYear(),r.getMonth(),r.getDate()),G=window.document;v.prototype={_attachCalendar:function(c,a){if(this._getInst(c))return!1;var e=f(c),b=this,g=b._newInst(e);f.extend(g.settings,b._defaults,a);var d=0;if(1===c.nodeType&&"INPUT"==c.nodeName&&0<c.value.length){var d=D(c.value,g.settings.dateFormat).split("-"),d=new Date(parseInt(d[0],10),parseInt(d[1],10)-1,parseInt(d[2],10)),h=new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate());g.settings.year=h.getFullYear();
g.settings.month=h.getMonth();b.selectedDate=d}c.style.cursor="pointer";d=f("<div>",{id:["zui-calendar-container",g.uid].join("-")}).addClass("zui-calendar-container");g.settings.inline?d.appendTo(c):(d.css({display:"none",position:"absolute"}),e.bind("focus.calendar",function(a){g.isOpen?b._closeCalendar.call(b,c):b._openCalendar.call(b,c)}).bind("blur.calendar",function(a){g.isOpen&&!g.focus&&b._closeCalendar.call(b,c)}).bind("keydown.calendar",function(a){switch(a.charCode?a.charCode:a.keyCode?
a.keyCode:0){case 9:b._closeCalendar.call(b,c);break;case 27:b._closeCalendar.call(b,c)}}).bind("calendarbeforeOpen",function(a,b){null!==b.settings.beforeOpen&&b.settings.beforeOpen.call(c,a,b)}).bind("calendarbeforeClose",function(a,b){null!==b.settings.beforeClose&&b.settings.beforeClose.call(c,a,b)}).bind("calendaropen",function(a,b){null!==b.settings.open&&b.settings.open.call(c,a,b)}).bind("calendarclose",function(a,b){null!==b.settings.close&&b.settings.close.call(c,a,b)}),f("document").bind("mousedown.calendar",
function(a){var d=f,e;a||(a=window.event);a.target?e=a.target:a.srcElement&&(e=a.srcElement);3==e.nodeType&&(e=e.parentNode);d=d(e);d.hasClass("zui-calendar-container")||(d.hasClass("zui-calendar-table")||d.hasClass("zui-calendar-date")||d.hasClass("zui-calendar-today")||d.hasClass("zui-calendar-empty")||d.hasClass("zui-calendar-selected")||d.hasClass("zui-calendar-week")||d.hasClass("zui-calendar-nav")||d.hasClass("zui-calendar-navi")||d.hasClass("zui-calendar-month")||d.hasClass("zui-calendar-wday")||
d.hasClass("zui-calendar-wnum")||d.parent().hasClass("zui-calendar-container")||d.parent().hasClass("zui-calendar-table"))||b._closeCalendar.call(b,c)}),d.appendTo("body"));e.bind("calendarselect",function(a,b){null!==b.settings.select&&b.settings.select.call(c,a,b)});g.container=d;f.data(c,"calendar",g);for(var h=g.settings.year,n=g.settings.month,d=0;d<g.settings.months;d++)b._drawCalendar(c,h,n+d,t(d,g.settings.months));f(g.container).on("click",".zui-calendar-date",function(){var a=f(this);f("td",
g.container).removeClass("zui-calendar-selected");a.addClass("zui-calendar-selected");a=parseInt(a.attr("zui-calendar-date"),10);b.selectedDate=new Date(a);g.settings.year=b.selectedDate.getFullYear();g.settings.month=b.selectedDate.getMonth();g.settings.inline||(b._closeCalendar.call(b,c),c.value=b.formatDate(g.settings.dateFormat,a));e.trigger("calendarselect",g);b._refreshCalendar.call(b,c)})},formatDate:function(){return x.apply(this,arguments)},_drawCalendar:function(c,a,e,b,g){var d=this._getInst(c);
if(!d)return!1;var h=this,n=g===B?Math.floor(9999999*Math.random()):g,m=new Date(a,e,1),r=(new Date(a,e+1,0)).getDate(),u=(new Date(a,e,0)).getDate(),v=m.getUTCDay(),y=m.getDay(),l,z=0,x=d.settings.weekNumbers?8:7;g=f("<table>");var A=f("<thead>"),s=f("<tbody>"),q,k,p,C=!1;null!==d.settings.minDate&&(C=!0);q=f("<tr>");k=f("<th>");!d.settings.showNavigation||1!==b&&3!==b?k.addClass("zui-calendar-navi"):(k.click(function(b){f("#zui-calendar-container-"+d.uid).html("");for(l=0;l<d.settings.months;l++)h._drawCalendar(c,
a,e-d.settings.months+l,t(l,d.settings.months)),0===l&&(d.settings.month=e-d.settings.months,d.settings.year=a)}),k.addClass("zui-calendar-nav zui-unselectable").css({cursor:"pointer"}).text("<"));k.appendTo(q);k=f("<th>",{colSpan:7===x?5:6}).addClass("zui-calendar-month").text(d.settings.monthNamesFull[m.getMonth()]+" "+m.getFullYear()).appendTo(q);k=f("<th>");!d.settings.showNavigation||2!==b&&3!==b?k.addClass("zui-calendar-navi"):k.css({cursor:"pointer"}).addClass("zui-calendar-nav zui-unselectable").text(">").click(function(b){f("#zui-calendar-container-"+
d.uid).html("");for(l=0;l<d.settings.months;l++)h._drawCalendar(c,a,e+l+1,t(l,d.settings.months)),0===l&&(d.settings.month=e+1,d.settings.year=a)});k.appendTo(q);q.appendTo(A);q=f("<tr>");d.settings.weekNumbers&&(k=f("<th>").text("wk").addClass("zui-calendar-wnum").appendTo(q));for(l=0;7>l;l++)k=f("<th>").text(d.settings.dayNames[(d.settings.startDay+l)%7]).addClass("zui-calendar-wday").appendTo(q);q.appendTo(A);A.appendTo(g);for(b=d.settings.startDay+1-y;1<b;)b-=7;for(;b<=r;){m=new Date(a,e,b+v);
q=f("<tr>");d.settings.weekNumbers&&(k=f("<td>").addClass("zui-calendar-week"),m=new Date(m.getFullYear(),m.getMonth(),m.getDate()-(m.getDay()||7)+3),y=new Date(m.getFullYear(),0,4),k.text(1+Math.round((m-y)/864E5/7)).appendChild(q));for(l=0;7>l;l++)k=f("<td>"),0<b&&b<=r?(p=new Date(a,e,b),k.attr("zui-calendar-date",p.getTime()).addClass("zui-calendar-date"),E===[p.getFullYear(),p.getMonth(),p.getDate()].join("-")&&k.addClass("zui-calendar-today"),k.text(b),m=d.settings.onBeforeShowDay.apply(h,[p]),
!0===d.settings.disablePast&&p<F?k.addClass("zui-calendar-past"):C&&p<d.settings.minDate?k.addClass("zui-calendar-past"):!1===m[0]&&k.addClass(m[1])):(d.settings.showOtherMonths&&(p=0<b?b-r:u+b,m=0<b?e+1:e-1,k.text(p),p=new Date(a,m,p),k.attr("zui-calendar-date",p.getTime())),k.addClass("zui-calendar-empty")),null!==h.selectedDate&&(h.selectedDate.getTime()===p.getTime()&&d.settings.month===e)&&k.addClass("zui-calendar-selected"),k.appendTo(q),q.appendTo(s),b++;z++}5===z?w(d.settings.weekNumbers).appendTo(s):
4===z&&(w(d.settings.weekNumbers).appendTo(s),w(d.settings.weekNumbers).appendTo(s));g.addClass("zui-calendar-table");g.attr("id",["zui-calendar-table",n].join("-"));s.appendTo(g);g.click(function(a){d.focus=!0});(n=G.getElementById(["zui-calendar-table",n].join("-")))&&d.container.remove(n);g.appendTo(d.container);f.data(c,"calendar",d)},_openCalendar:function(c){var a=this._getInst(c);if(!a)return!1;var e;e=c;var b=0,g=0;if(e.offsetParent){do b+=e.offsetLeft,g+=e.offsetTop;while(e=e.offsetParent);
e=[b,g]}else e=void 0;b=f(c);b.trigger("calendarbeforeOpen",a);switch(a.settings.position){case "bottom":a.container.css({top:e[1]+c.offsetHeight+"px"});break;case "top":a.container.show(),a.container.css({top:e[1]-a.container.offsetHeight+"px"})}a.container.css({left:e[0]+"px"});a.container.show();b.trigger("calendaropen",a);a.isOpen=!0;a.focus=!0;f.data(c,"calendar",a)},_closeCalendar:function(c){var a=this._getInst(c);if(!a)return!1;var e=f(c);e.trigger("calendarbeforeClose",a);a.container.hide();
e.trigger("calendarclose",a);a.isOpen=!1;a.focus=!1;f.data(c,"calendar",a)},_destroyCalendar:function(c){var a=this._getInst(c);if(!a)return!1;c.style.cursor="text";a.container.parent().remove(a.container);f.data(c,"calendar",a)},_optionCalendar:function(c,a){var e=this._getInst(c);if(!e)return!1;switch(arguments.length){case 2:if(u("String",a)&&e.settings[a])return e.settings[a];if(u("Object",a))for(var b in a)a.hasOwnProperty(b)&&(e.settings[b]=a[b]);break;case 3:e.settings[a]&&(e.settings[a]=arguments[2])}f.data(c,
"calendar",e)},_refreshCalendar:function(c){var a=this._getInst(c);if(!a)return!1;var e,b=a.settings.year,g=a.settings.month;a.container.html("");for(e=0;e<a.settings.months;e++)this._drawCalendar(c,b,g+e,t(e,a.settings.months));f.data(c,"calendar",a)},_newInst:function(c){return{id:c[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:c,uid:Math.floor(99999999*Math.random()),focus:!1,isOpen:!1,isDisabled:!1,settings:{}}},_getInst:function(c){try{return f.data(c,"calendar")}catch(a){throw"Missing instance data for this calendar";
}}};f.fn.zinoCalendar=function(c){var a=Array.prototype.slice.call(arguments,1);return"string"==typeof c&&"isDisabled"==c||"option"==c&&2==arguments.length&&"string"==typeof arguments[1]?f.zinoCalendar["_"+c+"Calendar"].apply(f.zinoCalendar,[this[0]].concat(a)):this.each(function(){"string"==typeof c?f.zinoCalendar["_"+c+"Calendar"].apply(f.zinoCalendar,[this].concat(a)):f.zinoCalendar._attachCalendar(this,c)})};f.zinoCalendar=new v;f.zinoCalendar.version="1.3"})(jQuery);