/*!
 * ZinoUI v1.3 (http://zinoui.com)
 * Copyright 2012-2013 Dimitar Ivanov. All Rights Reserved.
 *
 * Zino UI commercial licenses may be obtained at http://zinoui.com/license
 * If you do not own a commercial license, this file shall be governed by the
 * GNU General Public License (GPL) version 3.
 * For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
 */
(function(b,s){function m(){this._state=[];this._defaults={classHolder:"zui-selectbox-holder",classHolderDisabled:"zui-selectbox-holder-disabled",classSelector:"zui-selectbox-selector",classOptions:"zui-selectbox-options",classGroup:"zui-selectbox-group",classSub:"zui-selectbox-sub",classDisabled:"zui-selectbox-disabled",classToggleOpen:"zui-selectbox-toggle-open",classToggle:"zui-selectbox-toggle",classFocus:"zui-selectbox-focus",speed:200,effect:"slide",enable:null,disable:null,change:null,open:null,
close:null}}var n=!0;m.prototype={_isOpenSelectbox:function(b){return b?this._getInst(b).isOpen:!1},_isDisabledSelectbox:function(b){return b?this._getInst(b).isDisabled:!1},_attachSelectbox:function(c,a){function k(){var a,c,d=this.attr("id").split("_")[1];for(a in f._state)a!==d&&f._state.hasOwnProperty(a)&&(c=b("select[sb='"+a+"']")[0])&&f._closeSelectbox(c)}function e(a,l){var e=l&&l.sub?!0:!1,g=l&&l.disabled?!0:!1;a.each(function(a){a=b(this);var p=b("<li>"),l;a.is(":selected")&&(q.text(a.text()),
m=n);a.is(":disabled")||g?(l=b("<span>",{text:a.text()}).addClass(d.settings.classDisabled),e&&l.addClass(d.settings.classSub)):(l=b("<a>",{href:"#"+a.val(),rel:a.val()}).text(a.text()).bind("click.sb",function(a){a&&a.preventDefault&&a.preventDefault();a=t;var p=b(this);a.attr("id").split("_");f._changeSelectbox(c,p.attr("rel"),p.text());f._closeSelectbox(c)}).bind("mouseover.sb",function(){var a=b(this);a.parent().siblings().find("a").removeClass(d.settings.classFocus);a.addClass(d.settings.classFocus)}).bind("mouseout.sb",
function(){b(this).removeClass(d.settings.classFocus)}),e&&l.addClass(d.settings.classSub),a.is(":selected")&&l.addClass(d.settings.classFocus));l.appendTo(p);p.appendTo(r)})}if(this._getInst(c))return!1;var g=b(c),h=g.offset(),f=this,d=f._newInst(g),q,t,r,m=!1;g.find("optgroup");var s=g.find("option");g.attr("sb",d.uid);b.extend(d.settings,f._defaults,a);f._state[d.uid]=!1;g.bind("selectboxenable",function(a,b){null!==d.settings.enable&&d.settings.enable.call(c,a,b)}).bind("selectboxdisable",function(a,
b){null!==d.settings.disable&&d.settings.disable.call(c,a,b)}).bind("selectboxopen",function(a,b){null!==d.settings.open&&d.settings.open.call(c,a,b)}).bind("selectboxchange",function(a,b){null!==d.settings.change&&d.settings.change.call(c,a,b)}).bind("selectboxclose",function(a,b){null!==d.settings.close&&d.settings.close.call(c,a,b)});h=b("<div>",{id:"sbHolder_"+d.uid,"class":d.settings.classHolder,tabindex:g.attr("tabindex"),"aria-expanded":!1}).css({position:"absolute",top:h.top+"px",left:h.left+
"px"});q=b("<a>",{id:"sbSelector_"+d.uid,href:"#",click:function(a){a.preventDefault();k.apply(b(this),[]);a=b(this).attr("id").split("_")[1];f._state[a]?f._closeSelectbox(c):f._openSelectbox(c)}}).addClass(d.settings.classSelector).addClass("zui-unselectable");t=b("<a>",{id:"sbToggle_"+d.uid,href:"#","class":d.settings.classToggle,click:function(a){a.preventDefault();k.apply(b(this),[]);a=b(this).attr("id").split("_")[1];f._state[a]?f._closeSelectbox(c):f._openSelectbox(c)}});t.appendTo(h);r=b("<ul>",
{id:"sbOptions_"+d.uid,"class":d.settings.classOptions,css:{display:"none"}});g.children().each(function(a){a=b(this);var c,f={};a.is("option")?e.call(null,a):a.is("optgroup")&&(c=b("<li>"),b("<span>",{text:a.attr("label")}).addClass(d.settings.classGroup).appendTo(c),c.appendTo(r),a.is(":disabled")&&(f.disabled=!0),f.sub=!0,e.call(null,a.find("option"),f))});m||q.text(s.first().text());b.data(c,"selectbox",d);h.data("uid",d.uid).bind("keydown.sb",function(a){var c=a.charCode?a.charCode:a.keyCode?
a.keyCode:0,d=b(this),e=d.data("uid"),g=d.siblings("select[sb='"+e+"']").data("selectbox"),k=d.siblings(["select[sb='",e,"']"].join("")).get(0),h=d.find("ul").find("a."+g.settings.classFocus);switch(c){case 37:case 38:0<h.length&&(b("a",d).removeClass(g.settings.classFocus),c=h.parent().prevAll("li:has(a)").eq(0).find("a"),0<c.length&&(c.addClass(g.settings.classFocus).focus(),b("#sbSelector_"+e).text(c.text())));break;case 39:case 40:b("a",d).removeClass(g.settings.classFocus);c=0<h.length?h.parent().nextAll("li:has(a)").eq(0).find("a"):
d.find("ul").find("a").eq(0);0<c.length&&(c.addClass(g.settings.classFocus).focus(),b("#sbSelector_"+e).text(c.text()));break;case 13:0<h.length&&f._changeSelectbox(k,h.attr("rel"),h.text());f._closeSelectbox(k);break;case 9:k&&(g=f._getInst(k))&&(0<h.length&&f._changeSelectbox(k,h.attr("rel"),h.text()),f._closeSelectbox(k));e=parseInt(d.attr("tabindex"),10);a.shiftKey?e--:e++;b("*[tabindex='"+e+"']").focus();break;case 27:f._closeSelectbox(k)}a.stopPropagation();return!1}).delegate("a","mouseover.sb",
function(a){b(this).addClass(d.settings.classFocus)}).delegate("a","mouseout.sb",function(a){b(this).removeClass(d.settings.classFocus)});q.appendTo(h);r.appendTo(h);h.appendTo(document.body);g.css({"data-width":g.width(),"data-height":g.height()}).css({visibility:"hidden",width:h.outerWidth()+"px",height:h.outerHeight()+"px"});b(window).delegate("html","mousedown.sb",function(a){a.stopPropagation();b("select").zinoSelectbox("close")});b([".",d.settings.classHolder,", .",d.settings.classSelector].join("")).mousedown(function(a){a.stopPropagation()});
g.is(":disabled")&&f._disableSelectbox(c)},_destroySelectbox:function(c){var a=this._getInst(c);if(!a)return!1;b("#sbHolder_"+a.uid).remove();b.data(c,"selectbox",null);c=b(c);c.css({visibility:"visible",width:c.data("width")+"px",height:c.data("height")+"px"}).removeAttr("sb")},_changeSelectbox:function(c,a,k){var e=this._getInst(c);e&&b("#sbSelector_"+e.uid).text(k);a=a.replace(/\'/g,"\\'");b(c).find("option[value='"+a+"']").attr("selected",n);e?b(c).trigger("selectboxchange",{input:e.input?e.input[0]:
null,value:a,text:k}):e&&e.input&&e.input.trigger("change")},_enableSelectbox:function(c){var a=this._getInst(c);if(!a||!a.isDisabled)return!1;b("#sbHolder_"+a.uid).removeClass(a.settings.classHolderDisabled);a.isDisabled=!1;b(c).trigger("selectboxenable",{input:a.input?a.input[0]:null});b.data(c,"selectbox",a)},_disableSelectbox:function(c){var a=this._getInst(c);if(!a||a.isDisabled)return!1;b("#sbHolder_"+a.uid).addClass(a.settings.classHolderDisabled);a.isDisabled=n;b(c).trigger("selectboxdisable",
{input:a.input?a.input[0]:null});b.data(c,"selectbox",a)},_optionSelectbox:function(c,a,k){var e=this._getInst(c);if(!e)return!1;e[a]=k;b.data(c,"selectbox",e)},_openSelectbox:function(c){var a=this._getInst(c);if(a&&!a.isOpen&&!a.isDisabled){var k=b("#sbOptions_"+a.uid),e=parseInt(b(window).height(),10),g=b("#sbHolder_"+a.uid),h=g.offset(),f=b(window).scrollTop(),d=k.prev().height(),e=e-(h.top-f)-d/2;g.attr("aria-expanded",!0);k.css({top:d+"px",maxHeight:e-d+"px"});"fade"===a.settings.effect?k.fadeIn(a.settings.speed):
k.slideDown(a.settings.speed);b("#sbToggle_"+a.uid).addClass(a.settings.classToggleOpen);this._state[a.uid]=n;a.isOpen=n;b(c).trigger("selectboxopen",{input:a.input?a.input[0]:null});b.data(c,"selectbox",a)}},_closeSelectbox:function(c){var a=this._getInst(c);a&&a.isOpen&&("fade"===a.settings.effect?b("#sbOptions_"+a.uid).fadeOut(a.settings.speed):b("#sbOptions_"+a.uid).slideUp(a.settings.speed),b("#sbToggle_"+a.uid).removeClass(a.settings.classToggleOpen),b("#sbHolder_"+a.uid).attr("aria-expanded",
!1),this._state[a.uid]=!1,a.isOpen=!1,b(c).trigger("selectboxclose",{input:a.input?a.input[0]:null}),b.data(c,"selectbox",a))},_newInst:function(b){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,uid:Math.floor(99999999*Math.random()),isOpen:!1,isDisabled:!1,settings:{}}},_getInst:function(c){try{return b.data(c,"selectbox")}catch(a){throw"Missing instance data for this selectbox";}},_get:function(b,a){return b.settings[a]!==s?b.settings[a]:this._defaults[a]}};b.fn.zinoSelectbox=function(c){var a=
Array.prototype.slice.call(arguments,1);return"string"==typeof c&&"isDisabled"==c||"option"==c&&2==arguments.length&&"string"==typeof arguments[1]?b.zinoSelectbox["_"+c+"Selectbox"].apply(b.zinoSelectbox,[this[0]].concat(a)):this.each(function(){"string"==typeof c?b.zinoSelectbox["_"+c+"Selectbox"].apply(b.zinoSelectbox,[this].concat(a)):b.zinoSelectbox._attachSelectbox(this,c)})};b.zinoSelectbox=new m;b.zinoSelectbox.version="1.3"})(jQuery);