/*!
 * ZinoUI v1.3 (http://zinoui.com)
 * Copyright 2012-2013 Dimitar Ivanov. All Rights Reserved.
 *
 * Zino UI commercial licenses may be obtained at http://zinoui.com/license
 * If you do not own a commercial license, this file shall be governed by the
 * GNU General Public License (GPL) version 3.
 * For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
 */
(function(e,g){function h(){this._defaults={handle:null,lowerBound:null,upperBound:null,attachLater:!1,start:null,drag:null,end:null,enable:null,disable:null};this._internal={cursorStartPos:null,elementStartPos:null,dragging:!1,listening:!1,disposed:!1}}h.prototype={_attachDraggable:function(a,b){if(this._getInst(a))return!1;var d=e(a),c=this._newInst(d);e.extend(c.settings,this._defaults,b);e.extend(c.internal,this._internal);null!==c.settings.lowerBound&&zino.Position!==g&&(c.settings.lowerBound=
new zino.Position(c.settings.lowerBound[0],c.settings.lowerBound[1]));null!==c.settings.upperBound&&zino.Position!==g&&(c.settings.upperBound=new zino.Position(c.settings.upperBound[0],c.settings.upperBound[1]));"string"==typeof c.settings.handle&&0<c.settings.handle.length&&(c.settings.handle=e(c.settings.handle,a));c.$handle=null!==c.settings.handle?c.settings.handle:d;if(null!=c.settings.lowerBound&&null!=c.settings.upperBound){var f=c.settings.lowerBound.min(c.settings.upperBound);c.settings.upperBound=
c.settings.lowerBound.max(c.settings.upperBound);c.settings.lowerBound=f}d.addClass("zui-draggable").css("position","absolute").bind("draggablestart",function(b,d){null!==c.settings.start&&c.settings.start.call(a,b,d)}).bind("draggabledrag",function(b,d){null!==c.settings.drag&&c.settings.drag.call(a,b,d)}).bind("draggableend",function(b,d){null!==c.settings.end&&c.settings.end.call(a,b,d)}).bind("draggableenable",function(b,d){null!==c.settings.enable&&c.settings.enable.call(a,b,d)}).bind("draggabledisable",
function(b,d){null!==c.settings.disable&&c.settings.disable.call(a,b,d)});e.data(a,"draggable",c);c.settings.attachLater||this._startListening.call(this,a)},_enableDraggable:function(a){var b=this._getInst(a);if(!b)return!1;b.isDisabled&&(b.isDisabled=!1,this._startListening.call(this,a),e(a).trigger("draggableenable",{}),e.data(a,"draggable",b))},_disableDraggable:function(a){var b=this._getInst(a);if(!b)return!1;b.isDisabled||(b.isDisabled=!0,this._stopListening.call(this,a,!0),e(a).trigger("draggabledisable",
{}),e.data(a,"draggable",b))},_dragStart:function(a,b){var d=this._getInst(a);if(!d)return!1;var c=this,f=e(a);if(!d.internal.dragging&&d.internal.listening&&!d.internal.disposed)return d.internal.dragging=!0,f.trigger("draggablestart",{handle:d.$handle.get(0)}),d.internal.cursorStartPos=zino.Position.getCursor(b),d.internal.elementStartPos=new zino.Position(parseInt(f.css("left")),parseInt(f.css("top"))),d.internal.elementStartPos=d.internal.elementStartPos.check(),f.focus(),e(document).bind("mousemove.draggable",
function(b){c._dragGo.call(c,a,b)}).bind("mouseup.draggable",function(b){c._dragStopHook.call(c,a,b)}),e.data(a,"draggable",d),b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),!1},_dragGo:function(a,b){var d=this._getInst(a);if(!d)return!1;var c=e(a);if(d.internal.dragging&&!d.internal.disposed){var f=zino.Position.getCursor(b),f=f.add(d.internal.elementStartPos).subtract(d.internal.cursorStartPos),f=f.bound(d.settings.lowerBound,d.settings.upperBound);f.apply(c);c.trigger("draggabledrag",
{handle:d.$handle.get(0)});b.stopPropagation&&b.stopPropagation();b.preventDefault&&b.preventDefault();return!1}},_dragStopHook:function(a,b){if(!this._getInst(a))return!1;this._dragStop.call(this,a,b);b.stopPropagation&&b.stopPropagation();b.preventDefault&&b.preventDefault();return!1},_dragStop:function(a,b){var d=this._getInst(a);if(!d)return!1;var c=this,f=e(a);d.internal.dragging&&!d.internal.disposed&&(e(document).unbind("mousemove.draggable",function(b){c._dragGo.call(c,a,b)}),e(document).unbind("mouseup.draggable",
function(b){c._dragStopHook.call(c,a,b)}),d.internal.cursorStartPos=null,d.internal.elementStartPos=null,f.trigger("draggableend",{handle:d.$handle.get(0)}),d.internal.dragging=!1,e.data(a,"draggable",d))},_destroyDraggable:function(a){var b=this._getInst(a);if(!b)return!1;b.internal.disposed||(e(a).removeClass("zui-draggable"),this._stopListening.call(this,a,!0),e.data(a,"draggable",null))},_startListening:function(a){var b=this._getInst(a);if(!b)return!1;var d=this;b.internal.listening||b.internal.disposed||
(b.internal.listening=!0,b.$handle.bind("mousedown.draggable",function(b){d._dragStart.call(d,a,b)}),e.data(a,"draggable",b))},_stopListening:function(a,b){var d=this._getInst(a);if(!d)return!1;var c=this;d.internal.listening&&!d.internal.disposed&&(d.$handle.unbind("mousedown.draggable",function(b){c._dragStart.call(c,a,b)}),d.internal.listening=!1,b&&d.internal.dragging&&c._dragStop.call(c,a),e.data(a,"draggable",d))},_isDragging:function(a){return a?this._getInst(a).internal.dragging:!1},_isListening:function(a){return a?
this._getInst(a).internal.listening:!1},_isDisposed:function(a){return a?this._getInst(a).internal.disposed:!1},_newInst:function(a){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,uid:Math.floor(99999999*Math.random()),isDisabled:!1,settings:{},internal:{}}},_getInst:function(a){try{return e.data(a,"draggable")}catch(b){throw"Missing instance data for this draggable";}}};e.fn.zinoDraggable=function(a){var b=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&"isDisabled"==
a||"option"==a&&2==arguments.length&&"string"==typeof arguments[1]?e.zinoDraggable["_"+a+"Draggable"].apply(e.zinoDraggable,[this[0]].concat(b)):this.each(function(){"string"==typeof a?e.zinoDraggable["_"+a+"Draggable"].apply(e.zinoDraggable,[this].concat(b)):e.zinoDraggable._attachDraggable(this,a)})};e.zinoDraggable=new h;e.zinoDraggable.version="1.3"})(jQuery);